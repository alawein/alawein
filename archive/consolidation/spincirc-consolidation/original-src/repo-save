#!/bin/bash
# Universal: Stage all, commit, and push changes
# Usage: repo-save ["optional custom message"]

if [ ! -d ".git" ]; then
    echo "âŒ Not in a Git repository!"
    exit 1
fi

REPO_NAME=$(basename "$(pwd)")
echo "ğŸ’¾ Saving changes to: $REPO_NAME"
echo ""

# Auto-generate commit message if none provided
if [ -z "$1" ]; then
    COMMIT_MSG="Update $(date '+%Y-%m-%d %H:%M')"
    echo "ğŸ¤– Auto-generated commit message: \"$COMMIT_MSG\""
else
    COMMIT_MSG="$1"
    echo "ğŸ’¾ Using custom message: \"$COMMIT_MSG\""
fi

echo "ğŸ“ Staging all changes..."
git add .

echo "ğŸ’¾ Committing..."
git commit -m "$COMMIT_MSG"

echo "ğŸš€ Pushing to GitHub..."
git push origin main || git push origin master || echo "âš ï¸  Could not push (check branch name)"

echo ""
echo "âœ… All changes saved and pushed!"