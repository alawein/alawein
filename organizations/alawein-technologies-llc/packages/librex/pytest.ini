[pytest]
# Pytest configuration for Optilibria comprehensive test suite

# Test discovery
testpaths = optilibria/tests tests
python_files = test_*.py *_test.py
python_classes = Test*
python_functions = test_*

# Test execution options
addopts =
    -v
    --strict-markers
    --tb=short
    --color=yes
    --cov=Librex.benchmarks.qaplib.embedded_data
    --cov-report=term-missing:skip-covered
    --cov-report=html:htmlcov
    --cov-report=xml
    --cov-branch
    --cov-fail-under=90
    --durations=10
    --maxfail=5

# Test markers for categorization
markers =
    # Test categories
    unit: Unit tests for individual components
    integration: Integration tests for workflows
    e2e: End-to-end flows (longer/higher scope)

    # Performance markers
    slow: Slow running tests (deselect with '-m "not slow"')
    benchmark: Performance benchmark tests
    performance: Performance-critical checks

    # Feature-specific markers
    qaplib: QAPLIB benchmark suite tests
    ai_selector: AI method selector tests
    advanced_methods: Advanced optimization method tests
    quantum: Quantum computing integration tests
    visualization: Visualization and plotting tests
    utilities: Utility function tests

    # Method-specific markers
    aco: Ant Colony Optimization tests
    pso: Particle Swarm Optimization tests
    vns: Variable Neighborhood Search tests
    ils: Iterated Local Search tests
    grasp: GRASP algorithm tests

    # Dependency markers
    fft_laplace: FFT-Laplace novel method suite tests
    theorem: Tests requiring theorem prover/z3 dependency
    gpu: Tests requiring GPU acceleration
    network: Tests requiring network access
    redis: Tests requiring Redis connection

# Coverage settings
[coverage:run]
source =
    Librex.benchmarks.qaplib.embedded_data
omit =
    */tests/*
    */test_*.py
    */__pycache__/*
    */site-packages/*

[coverage:report]
precision = 2
skip_empty = True
show_missing = True

# Ignore warnings
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    ignore::FutureWarning:numpy
    ignore::RuntimeWarning:scipy
    ignore::UserWarning:matplotlib

# Output options
console_output_style = progress
log_cli = false
log_cli_level = INFO
log_file = tests.log
log_file_level = DEBUG

# Timeout settings
timeout = 300
timeout_method = thread

# Parallel execution settings (use with pytest-xdist)
# Run with: pytest -n auto
workers = auto

# Directories to ignore
norecursedirs = .git .tox dist build *.egg htmlcov .pytest_cache __pycache__
